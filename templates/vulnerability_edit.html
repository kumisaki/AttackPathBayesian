{% extends "base.html" %}
{% block content %}
<h2>Edit Vulnerability</h2>
<form method="POST" action="{{ url_for('vuln_bp.edit_vulnerability', vuln_id=vulnerability._id) }}">
    <div class="form-group">
        <label for="vuln_id">Vulnerability ID</label>
        <input type="text" class="form-control" id="vuln_id" name="vuln_id" value="{{ vulnerability._id }}" disabled>
    </div>
    <div class="form-group">
        <label for="desc">Description</label>
        <input type="text" class="form-control" id="desc" name="desc" value="{{ vulnerability.desc }}" required>
    </div>
    <div class="form-group">
        <label for="cvss">CVSS Score (0-10)</label>
        <input type="number" class="form-control" id="cvss" name="cvss" step="0.1" min="0" max="10" value="{{ vulnerability.cvss }}" required>
    </div>
    <div class="form-group">
        <label for="epss">EPSS (0-1)</label>
        <input type="number" class="form-control" id="epss" name="epss" step="0.01" min="0" max="1" value="{{ vulnerability.epss }}" required>
    </div>
    <div class="form-group">
        <label for="parent_device_id">Parent Device ID</label>
        <select class="form-control" id="parent_device_id" name="parent_device_id" required>
            {% for device in devices %}
            <option value="{{ device._id }}" {% if device._id == vulnerability.parent_device_id %}selected{% endif %}>
                {{ device.label }} ({{ device.ip_address }})
            </option>
            {% endfor %}
        </select>
    </div>
    <button type="submit" class="btn btn-primary">Update Vulnerability</button>
</form>
{% endblock %}
