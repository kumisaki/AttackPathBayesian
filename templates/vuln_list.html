{% extends "base.html" %}
{% block content %}
<h2>漏洞列表</h2>
<a href="{{ url_for('vuln_bp.vuln_add_page') }}" class="btn btn-primary mb-3">
  添加/上传漏洞
</a>
<table class="table table-bordered table-hover">
  <thead>
    <tr>
      <th>IP地址</th>
      <th>CVE</th>
      <th>描述</th>
      <th>CVSS</th>
      <th>EPSS</th>
      <th>严重度</th>
      <th>攻击概率</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for v in vulns %}
    <tr>
      <td>{{ v.ip_address }}</td>
      <td>{{ v.cve_id }}</td>
      <td>{{ v.description }}</td>
      <td>{{ v.cvss }}</td>
      <td>{{ v.epss }}</td>
      <td>{{ v.severity }}</td>
      <td>{{ v.attack_probability }}</td>
      <td>
        <a href="{{ url_for('vuln_bp.vuln_edit', vuln_id=v._id) }}" 
           class="btn btn-info btn-sm">编辑</a>
        <a href="{{ url_for('vuln_bp.vuln_delete', vuln_id=v._id) }}" 
           class="btn btn-danger btn-sm"
           onclick="return confirm('确认删除此漏洞?');">
          删除
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
